{% extends "/shared/_base.html" %}
{% block content %}
    <header>
        <section class="hero is-primary">
            <div class="hero-body">
                <div class="container">
                    <p>SUBBOX - DJS</p>
                </div>
            </div>
        </section>
    </header>
    <section class="section">
        <div class="container content">
            <h1 class="title is-1">Overview</h1>
            <p>Subbox allows you to convert to and from your DJ software collection to sub box.</p>
            <p>This means you can stream, edit and organise your collection on the go using sub box and then convert your updates in to the format required for your DJ controller.</p>
            <p>To begin you can export your collection from your DJ software and upload to subbox so you can start streaming it.</p>
            <h1 class="subtitle is-1">Import</h1>
            <p>Currently only importing from a Rekordbox 5 collection is supported. Tested with Rekordbox 5.8.7.</p>
            <h1 class="subtitle is-3">Rekordbox 5</h1>
            <p>To import from RB 5</p>
            <ol>
                <li>export your RB collection (File->Library->Backup Library. Make sure you select 'yes' to backing up music files as well. This will create a 'rekordbox_bak' folder with the music files in. It will also create a zip folder but this is not needed.</li>
                <li>backup your collection as an xml (File -> Export Collection in xml format). This contains all the playlist data neeted to create your playlists in subbox.</li>
            </ol>
            <p>Once the above has been compelted in rekordbox, upload the resulting xml and rekordbox_bak directory containing the tracks to subbox <a href="/upload">here</a>. Then click process below.</p>
            <div id="rb-result" hx-target="this" hx-swap="outerHTML">
                <div hx-post="/djs/upload/rekordbox" hx-trigger="start-rekordbox-import from:body" hx-indicator="#spinner">
                </div>
            </div>

            <div id="rb-progress" hx-target="this" hx-swap="outerHTML">
                <div id="process">
                    <p>
                        Process uploaded rb collection.
                    </p>
                </div>
                <p>
                    once you have uploaded rb backup and rb xml, click the process music button. This will import your collection.
                </p>
                <!-- todo do some validation here and only show the progress button iff there are uploaded tracks-->
                <button id="start-rb-upload" hx-get="/job/progress" class="button is-primary" hx-vals='{"type": "start-rekordbox-import"}'>
                    process
                </button>

                <h1 class="subtitle is-1">Export</h1>

                <h1 class="subtitle is-3">RekordBox 5</h1>
                <p>Currently only importing from a Rekordbox 5 collection is supported. Tested with Rekordbox 5.8.7.</p>
                <div id="export">
                    <p>
                        export subbox collection to rb.
                    </p>
                </div>
                <p>
                    once you have made changes in sub box (adding more tracks or creating/modifying playlists) export to rekordbox. This will create a zip of your collection in subbox that can be downloaded here. It also creates an xml of the collection that can be imported in to rekordbox.
                </p>
                <form id="exportform">
                    <div>
                        <label>local root</label>
                        <input type="text" name="local_root" value="<enter-here>">
                        <p>set the local root for where you will extract the zip and xml exported from subbox to on your local machine. For example: `/Users/my_username/music/subbox`</p>
                    </div>
                    <!-- todo do some validation here and only show the progress button iff there are uploaded tracks-->
                    <button class="button is-primary" hx-post="/djs/export/rekordbox" hx-indicator="#spinner" hx-swap="innerHTML">
                        Export
                        <img id="spinner" class="htmx-indicator loader" src="/imgs/spin">
                    </button>
                </form>
            </div>
        </div>
    </section>
{% endblock %}